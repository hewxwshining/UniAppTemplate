{"version":3,"file":"CustomNavbar.js","sources":["components/CustomNavbar/CustomNavbar.vue","E:/ProgramFilesForTools/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RjovdW5pQXBwVGVtcGxhdGUvY29tcG9uZW50cy9DdXN0b21OYXZiYXIvQ3VzdG9tTmF2YmFyLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"custom-navbar\" :style=\"navbarStyle\">\r\n\t\t<!-- 导航栏内容 -->\r\n\t\t<view class=\"navbar-content\" :style=\"{ height: statusNavHeight + 'px' }\">\r\n\t\t\t<!-- 左侧区域 -->\r\n\t\t\t<view class=\"navbar-left\">\r\n\t\t\t\t<view v-if=\"showBack\" class=\"back-btn\" @click=\"handleBack\">\r\n\t\t\t\t\t<uni-icons type=\"left\" size=\"24\" color=\"#fff\"></uni-icons>\r\n\t\t\t\t</view>\r\n\t\t\t\t<slot name=\"left\"></slot>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 中间标题区域 -->\r\n\t\t\t<view class=\"navbar-center\">\r\n\t\t\t\t<text class=\"navbar-title\" :style=\"titleStyle\">{{ title }}</text>\r\n\t\t\t\t<slot name=\"center\"></slot>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 右侧区域 -->\r\n\t\t\t<view class=\"navbar-right\">\r\n\t\t\t\t<slot name=\"right\"></slot>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n\timport { ref, computed, getCurrentInstance } from \"vue\";\r\n\timport { onLoad, onReady, onShow, onHide } from \"@dcloudio/uni-app\";\r\n\r\n\tconst emit = defineEmits([\"back\"]);\r\n\tconst props = withDefaults(\r\n\t\tdefineProps<{\r\n\t\t\ttitle ?: string;\r\n\t\t\tshowBack ?: boolean;\r\n\t\t\tbackgroundColor ?: string;\r\n\t\t\ttitleColor ?: string;\r\n\t\t\tborderColor ?: string;\r\n\t\t\tcustomStyle ?: any;\r\n\t\t}>(),\r\n\t\t{\r\n\t\t\ttitle: \"默认标题\",\r\n\t\t\tshowBack: false,\r\n\t\t\tbackgroundColor: \"\",\r\n\t\t\ttitleColor: \"#fff\",\r\n\t\t\tcustomStyle: {},\r\n\t\t}\r\n\t);\r\n\r\n\tconst navbarStyle = computed(() => {\r\n\t\tconst style = {\r\n\t\t\tbackgroundColor: props.backgroundColor,\r\n\t\t\tborderBottom: props.borderColor ? `1px solid ${props.borderColor}` : null,\r\n\t\t\tpaddingTop: curStatusBarHeight.value + \"px\",\r\n\t\t\theight: curStatusBarHeight.value + statusNavHeight.value + \"px\",\r\n\t\t\t...props?.customStyle,\r\n\t\t};\r\n\t\treturn style;\r\n\t});\r\n\tconst titleStyle = computed(() => {\r\n\t\treturn {\r\n\t\t\tcolor: props.titleColor,\r\n\t\t};\r\n\t});\r\n\r\n\t// 是否有 back 事件监听（Vue3 事件监听不在 $attrs，需要从 vnode.props 读取）\r\n\tconst instance = getCurrentInstance();\r\n\tconst hasBackListener = computed(() => {\r\n\t\tconst vnodeProps = instance?.vnode?.props as\r\n\t\t\t| Record<string, unknown>\r\n\t\t\t| undefined;\r\n\t\treturn !!(vnodeProps && vnodeProps.onBack);\r\n\t});\r\n\tconst curStatusBarHeight = ref(0);\r\n\tconst statusNavHeight = ref(44); // 自定义导航栏内容区高度(默认值，单位px)\r\n\t// 获取状态栏高度\r\n\tconst getStatusBarHeight = () => {\r\n\r\n\t\tconst {\r\n\t\t\tstatusBarHeight\r\n\t\t} = uni.getWindowInfo()\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\tcurStatusBarHeight.value = statusBarHeight || 0;\r\n\r\n\t\t// 在微信小程序中，获取胶囊按钮信息以计算导航栏高度\r\n\t\tconst menuButtonInfo = uni.getMenuButtonBoundingClientRect();\r\n\t\tstatusNavHeight.value =\r\n\t\t\t(menuButtonInfo.top - curStatusBarHeight.value) * 2 + menuButtonInfo.height;\r\n\r\n\t};\r\n\r\n\t// 返回按钮点击事件\r\n\tconst handleBack = () => {\r\n\t\temit(\"back\");\r\n\t\t// 如果没有监听 back 事件，则执行默认返回逻辑\r\n\t\tif (!hasBackListener.value) {\r\n\t\t\tuni.navigateBack({\r\n\t\t\t\tfail: () => {\r\n\t\t\t\t\t// 如果无法返回，则跳转到首页\r\n\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\turl: \"/pages/index/index\",\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\t// 获取导航栏总高度\r\n\tconst getNavBarHeight = () => {\r\n\t\treturn curStatusBarHeight.value + statusNavHeight.value;\r\n\t};\r\n\r\n\t// 暴露方法给父组件\r\n\tdefineExpose({\r\n\t\tgetNavBarHeight,\r\n\t});\r\n\r\n\tonLoad(() => {\r\n\t\tgetStatusBarHeight();\r\n\t});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.custom-navbar {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\tz-index: 1000;\r\n\t\t/* 确保导航栏在最前 */\r\n\t\twidth: 100%;\r\n\r\n\t\t.navbar-content {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\theight: 44px;\r\n\t\t\tpadding: 0 15px;\r\n\t\t\tposition: relative;\r\n\r\n\t\t\t.navbar-left {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmin-width: 60px;\r\n\r\n\t\t\t\t.back-btn {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tjustify-content: center;\r\n\t\t\t\t\twidth: 32px;\r\n\t\t\t\t\theight: 32px;\r\n\t\t\t\t\tborder-radius: 50%;\r\n\t\t\t\t\ttransition: background-color 0.3s;\r\n\r\n\t\t\t\t\t&:active {\r\n\t\t\t\t\t\tbackground-color: rgba(0, 0, 0, 0.1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.navbar-center {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tleft: 50%;\r\n\t\t\t\ttop: 50%;\r\n\t\t\t\ttransform: translate(-50%, -50%);\r\n\t\t\t\tmax-width: calc(100% - 120px);\r\n\r\n\t\t\t\t.navbar-title {\r\n\t\t\t\t\tfont-size: 34rpx;\r\n\t\t\t\t\tfont-weight: 600;\r\n\t\t\t\t\tcolor: #333333;\r\n\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\toverflow: hidden;\r\n\t\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\t\twhite-space: nowrap;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.navbar-right {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: flex-end;\r\n\t\t\t\tmin-width: 60px;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from 'F:/uniAppTemplate/components/CustomNavbar/CustomNavbar.vue'\nwx.createComponent(Component)"],"names":["computed","getCurrentInstance","ref","uni","onLoad"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AA8BC,UAAM,OAAO;AACb,UAAM,QAAQ;AAkBR,UAAA,cAAcA,cAAAA,SAAS,MAAM;AAClC,YAAM,QAAQ;AAAA,QACb,iBAAiB,MAAM;AAAA,QACvB,cAAc,MAAM,cAAc,aAAa,MAAM,WAAW,KAAK;AAAA,QACrE,YAAY,mBAAmB,QAAQ;AAAA,QACvC,QAAQ,mBAAmB,QAAQ,gBAAgB,QAAQ;AAAA,QAC3D,GAAG,+BAAO;AAAA,MAAA;AAEJ,aAAA;AAAA,IAAA,CACP;AACK,UAAA,aAAaA,cAAAA,SAAS,MAAM;AAC1B,aAAA;AAAA,QACN,OAAO,MAAM;AAAA,MAAA;AAAA,IACd,CACA;AAGD,UAAM,WAAWC,cAAAA;AACX,UAAA,kBAAkBD,cAAAA,SAAS,MAAM;;AAChC,YAAA,cAAa,0CAAU,UAAV,mBAAiB;AAG7B,aAAA,CAAC,EAAE,cAAc,WAAW;AAAA,IAAA,CACnC;AACK,UAAA,qBAAqBE,kBAAI,CAAC;AAC1B,UAAA,kBAAkBA,kBAAI,EAAE;AAE9B,UAAM,qBAAqB,MAAM;AAE1B,YAAA;AAAA,QACL;AAAA,MAAA,IACGC,cAAAA,MAAI;AAQR,yBAAmB,QAAQ,mBAAmB;AAGxC,YAAA,iBAAiBA,oBAAI;AAC3B,sBAAgB,SACd,eAAe,MAAM,mBAAmB,SAAS,IAAI,eAAe;AAAA,IAAA;AAKvE,UAAM,aAAa,MAAM;AACxB,WAAK,MAAM;AAEP,UAAA,CAAC,gBAAgB,OAAO;AAC3BA,sBAAAA,MAAI,aAAa;AAAA,UAChB,MAAM,MAAM;AAEXA,0BAAAA,MAAI,SAAS;AAAA,cACZ,KAAK;AAAA,YAAA,CACL;AAAA,UACF;AAAA,QAAA,CACA;AAAA,MACF;AAAA,IAAA;AAGD,UAAM,kBAAkB,MAAM;AACtB,aAAA,mBAAmB,QAAQ,gBAAgB;AAAA,IAAA;AAItC,aAAA;AAAA,MACZ;AAAA,IAAA,CACA;AAEDC,kBAAAA,OAAO,MAAM;AACO;IAAA,CACnB;;;;;;;;;;;;;;;;;;;;;AC3HF,GAAG,gBAAgB,SAAS;"}