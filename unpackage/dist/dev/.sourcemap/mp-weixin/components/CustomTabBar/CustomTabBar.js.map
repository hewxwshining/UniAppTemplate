{"version":3,"file":"CustomTabBar.js","sources":["components/CustomTabBar/CustomTabBar.vue","E:/ProgramFilesForTools/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RjovdW5pQXBwVGVtcGxhdGUvY29tcG9uZW50cy9DdXN0b21UYWJCYXIvQ3VzdG9tVGFiQmFyLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"custom-tabbar-wrapper\" :style=\"tabBarStyle\">\r\n\t\t<view class=\"custom-tabbar\" :style=\"{ height: statusTabBarHeight + 'px' }\">\r\n\t\t\t<view v-for=\"(item, index) in visibleTabList\" :key=\"index\" class=\"tabbar-item\"\r\n\t\t\t\t:class=\"{ active: currentPagePath === item.pagePath }\" @click=\"handleTabClick(item, index)\">\r\n\t\t\t\t<image :src=\"\r\n            currentPagePath === item.pagePath\r\n              ? item.selectedIconPath\r\n              : item.iconPath\r\n          \" class=\"tabbar-icon\" mode=\"aspectFit\" />\r\n\t\t\t\t<text class=\"tabbar-text\" :style=\"{\r\n            color: currentPagePath === item.pagePath ? selectedColor : color,\r\n          }\">\r\n\t\t\t\t\t{{ item.text }}\r\n\t\t\t\t</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n\timport { onLoad, onReady, onShow, onHide } from \"@dcloudio/uni-app\";\r\n\timport { ref, computed, onMounted } from \"vue\";\r\n\timport { CustomTabbarProps } from \"./CustomTabbar\";\r\n\timport { useTabBarStore } from \"@/store\";\r\n\timport { TabBarItem } from \"@/store/modules/tabBar\";\r\n\r\n\tconst props = withDefaults(defineProps<CustomTabbarProps>(), {\r\n\t\tshow: true,\r\n\t\tcolor: \"#a0a0a0\",\r\n\t\tselectedColor: \"#428ac6\",\r\n\t\tbackgroundColor: \"#fff\",\r\n\t});\r\n\r\n\tconst tabBarStyle = computed(() => {\r\n\t\tconst style = {\r\n\t\t\theight: statusSaveHeight.value + statusTabBarHeight.value + \"px\",\r\n\t\t\tpaddingBottom: statusSaveHeight.value + \"px\",\r\n\t\t};\r\n\t\treturn style;\r\n\t});\r\n\r\n\tconst statusSaveHeight = ref(0);\r\n\tconst statusTabBarHeight = ref(60);\r\n\r\n\tconst tabBarStore = useTabBarStore();\r\n\r\n\tconst visibleTabList = computed(() => {\r\n\t\treturn tabBarStore.tabBarList\r\n\t})\r\n\r\n\r\n\t// 获取当前页面路径\r\n\tconst getCurrentPagePath = () => {\r\n\t\tconst pages = getCurrentPages();\r\n\t\tconst currentPage = pages[pages.length - 1];\r\n\t\treturn currentPage ? currentPage.route : \"\";\r\n\t};\r\n\r\n\t// 使用计算属性获取当前页面路径并判断高亮状态\r\n\tconst currentPagePath = computed(() => {\r\n\t\treturn getCurrentPagePath();\r\n\t});\r\n\r\n\t// 处理 tab 点击\r\n\tconst handleTabClick = (item : TabBarItem) => {\r\n\t\tif (currentPagePath.value === item.pagePath) return;\r\n\t\tuni.switchTab({\r\n\t\t\turl: `/${item.pagePath}`,\r\n\t\t\tsuccess: () => {\r\n\t\t\t\ttabBarStore.setTabBarPagePath(item.pagePath);\r\n\t\t\t},\r\n\t\t});\r\n\t};\r\n\r\n\t// 获取 TabBar 总高度（包括安全区域）\r\n\tconst setTabSaveHeight = () => {\r\n\r\n\t\tconst {\r\n\t\t\tsafeArea,\r\n\t\t\tscreenHeight,\r\n\t\t\tsafeAreaInsets\r\n\t\t} = uni.getWindowInfo()\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t// TODO fix by mehaotian 是否适配底部安全区 ,目前微信ios 、和 app ios 计算有差异，需要框架修复\r\n\t\tif (safeArea) {\r\n\r\n\t\t\tstatusSaveHeight.value = screenHeight - safeArea.bottom\r\n\r\n\r\n\r\n\r\n\t\t} else {\r\n\t\t\tstatusSaveHeight.value = 0\r\n\t\t}\r\n\t};\r\n\r\n\t// 获取 TabBar 内容区高度（不包括安全区域）\r\n\tconst getTabBarHeight = () => {\r\n\t\treturn statusSaveHeight.value + statusTabBarHeight.value; // 固定 60px\r\n\t};\r\n\r\n\t// 暴露方法给父组件\r\n\tdefineExpose({\r\n\t\tgetTabBarHeight,\r\n\t});\r\n\r\n\tonLoad(() => {\r\n\t\tsetTabSaveHeight();\r\n\t});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.custom-tabbar-wrapper {\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbackground-color: #D1EAFF;\r\n\t\t// 小程序会有安全距离\r\n\t\tpadding-bottom: constant(safe-area-inset-bottom);\r\n\t\tpadding-bottom: env(safe-area-inset-bottom);\r\n\r\n\t\t// 添加兼容性处理\r\n\t\t@supports not (padding-bottom: env(safe-area-inset-bottom)) {\r\n\t\t\tpadding-bottom: constant(safe-area-inset-bottom);\r\n\t\t}\r\n\r\n\t\t.custom-tabbar {\r\n\t\t\theight: 60px;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-around;\r\n\t\t\talign-items: center;\r\n\r\n\t\t\t.tabbar-item {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\theight: 100%;\r\n\r\n\t\t\t\t&.active {\r\n\t\t\t\t\t.tabbar-icon {\r\n\t\t\t\t\t\ttransform: scale(1.1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.tabbar-icon {\r\n\t\t\t\t\twidth: 40rpx;\r\n\t\t\t\t\theight: 40rpx;\r\n\t\t\t\t\tmargin-bottom: 4rpx;\r\n\t\t\t\t\ttransition: transform 0.2s;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.tabbar-text {\r\n\t\t\t\t\tfont-size: 20rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import Component from 'F:/uniAppTemplate/components/CustomTabBar/CustomTabBar.vue'\nwx.createComponent(Component)"],"names":["computed","ref","useTabBarStore","uni","onLoad"],"mappings":";;;;;;;;;;;;;;AAkCO,UAAA,cAAcA,cAAAA,SAAS,MAAM;AAClC,YAAM,QAAQ;AAAA,QACb,QAAQ,iBAAiB,QAAQ,mBAAmB,QAAQ;AAAA,QAC5D,eAAe,iBAAiB,QAAQ;AAAA,MAAA;AAElC,aAAA;AAAA,IAAA,CACP;AAEK,UAAA,mBAAmBC,kBAAI,CAAC;AACxB,UAAA,qBAAqBA,kBAAI,EAAE;AAEjC,UAAM,cAAcC,qBAAAA;AAEd,UAAA,iBAAiBF,cAAAA,SAAS,MAAM;AACrC,aAAO,YAAY;AAAA,IAAA,CACnB;AAID,UAAM,qBAAqB,MAAM;AAChC,YAAM,QAAQ;AACd,YAAM,cAAc,MAAM,MAAM,SAAS,CAAC;AACnC,aAAA,cAAc,YAAY,QAAQ;AAAA,IAAA;AAIpC,UAAA,kBAAkBA,cAAAA,SAAS,MAAM;AACtC,aAAO,mBAAmB;AAAA,IAAA,CAC1B;AAGK,UAAA,iBAAiB,CAAC,SAAsB;AACzC,UAAA,gBAAgB,UAAU,KAAK;AAAU;AAC7CG,oBAAAA,MAAI,UAAU;AAAA,QACb,KAAK,IAAI,KAAK,QAAQ;AAAA,QACtB,SAAS,MAAM;AACF,sBAAA,kBAAkB,KAAK,QAAQ;AAAA,QAC5C;AAAA,MAAA,CACA;AAAA,IAAA;AAIF,UAAM,mBAAmB,MAAM;AAExB,YAAA;AAAA,QACL;AAAA,QACA;AAAA,QACA;AAAA,MAAA,IACGA,cAAAA,MAAI;AAUR,UAAI,UAAU;AAEI,yBAAA,QAAQ,eAAe,SAAS;AAAA,MAAA,OAK3C;AACN,yBAAiB,QAAQ;AAAA,MAC1B;AAAA,IAAA;AAID,UAAM,kBAAkB,MAAM;AACtB,aAAA,iBAAiB,QAAQ,mBAAmB;AAAA,IAAA;AAIvC,aAAA;AAAA,MACZ;AAAA,IAAA,CACA;AAEDC,kBAAAA,OAAO,MAAM;AACK;IAAA,CACjB;;;;;;;;;;;;;;;;;;;;ACnHF,GAAG,gBAAgB,SAAS;"}